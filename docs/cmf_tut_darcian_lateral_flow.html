<!-- HTML header for doxygen 1.8.14-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <meta name="generator" content="Doxygen 1.10.0"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>cmf: Lateral Darcian flow</title>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="dynsections.js"></script>
    <script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
    <script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
    <script type="text/javascript">
        DoxygenAwesomeDarkModeToggle.init()
        DoxygenAwesomeFragmentCopyButton.init()
    </script>
    <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js"></script>
    <link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="cmf-logo-2018.svg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
  <div id="projectnumber">2.0.0b10</div>
   <div id="projectbrief">catchment modelling framework</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('cmf_tut_darcian_lateral_flow.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Lateral Darcian flow</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="el" href="cmf_tut_surface_runoff.html">next...</a></p>
<h1>Darcian flow connections</h1>
<p>Lateral subsurface flow in physically based models are usual based on some variant or simplification of Darcy's law. CMF has four different flux connections to describe the lateral subsurface flux between variable saturated soil layers. The naming conventions of the darcian flux connections are not chosen very well and are subject to change.</p>
<p>As a basis, all flux connections follow Darcy's equation:</p>
<p class="formulaDsp">
\[
 q = \nabla \Psi T w 
\]
</p>
<p>where:</p>
<ul>
<li>\(q\) is the flux between to horizontal adjacent soil layers in \(m^3/day\)</li>
<li>\(\nabla \Psi\) is the gradient over distance \(d [m]\)</li>
<li>\(T\) is the transmissivity between the layers in \(m^2/day\)</li>
<li>\(w\) is the width of the shared boundary of the layers in \(m\).</li>
</ul>
<p>The four variants of Darcy flow implemented in cmf differ in their way, how transmissivity \(T\) and the head gradient \(\nabla \Psi\) of the interface of two adjacent soil layers is calculated.</p>
<p>The following variants are available and explained below in detail:</p>
<ul>
<li>\(T_u\): unsaturated Transmissivity</li>
<li>\(T_s\): saturated Transmissivity</li>
<li>\(\nabla\Psi(\theta)\): Head based gradient</li>
<li>\(\nabla\Psi(z)\): Topographic gradient</li>
</ul>
<p>These variants lead to the four combinations of \(T\) and \(\nabla\Psi\):</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone">\(T_u\)   </th><th class="markdownTableHeadNone">\(T_s\)    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">\(\nabla\Psi(\theta)\)   </td><td class="markdownTableBodyNone"><a class="el" href="classcmf_1_1upslope_1_1connections_1_1_richards__lateral.html">Richards_lateral</a>   </td><td class="markdownTableBodyNone"><a class="el" href="classcmf_1_1upslope_1_1connections_1_1_darcy.html">Darcy</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">\(\nabla\Psi(z)\)   </td><td class="markdownTableBodyNone"><a class="el" href="classcmf_1_1upslope_1_1connections_1_1_darcy_kinematic.html">DarcyKinematic</a>   </td><td class="markdownTableBodyNone"><a class="el" href="classcmf_1_1upslope_1_1connections_1_1_topographic_gradient_darcy.html">TopographicGradientDarcy</a>   </td></tr>
</table>
<h2>Transmissivity variants</h2>
<h3>a) Unsaturated transmissivity \(T_u\)</h3>
<p class="formulaDsp">
\[
T(\theta) = K(\theta)\ \Delta z
\]
</p>
<p> where:</p>
<ul>
<li>\(K(\theta)\) is the harmonic mean of the unsaturated conductivity in \(\frac m{day}\), cf. <a class="el" href="cmf_tut_retentioncurve.html">retention curve</a></li>
<li>\(\Delta z\) is the thickness of the interface of the adjacent layers</li>
</ul>
<p>This transmissivity function is used in <a class="el" href="classcmf_1_1upslope_1_1connections_1_1_richards__lateral.html">Richards_lateral</a> and <a class="el" href="classcmf_1_1upslope_1_1connections_1_1_darcy_kinematic.html">DarcyKinematic</a></p>
<h3>b) Saturated transmissivity \(T_s\)</h3>
<p class="formulaDsp">
\[
 T_{sat}(\Psi) = K_{sat}\  (\Delta z + \Psi_M)
\]
</p>
<p>where:</p><ul>
<li>\(K_{sat}\) is the saturated conductivity in \(\frac m{day}\)</li>
<li>\(\Delta z + \Psi_M\) is the height of the water table above the layer bottom using the matrix potential \(\Psi_M\). If the saturated depth is below the lower layer thickness, the flow depth is 0.</li>
</ul>
<p>Used by <a class="el" href="classcmf_1_1upslope_1_1connections_1_1_darcy.html">Darcy</a> and <a class="el" href="classcmf_1_1upslope_1_1connections_1_1_topographic_gradient_darcy.html">TopographicGradientDarcy</a></p>
<h2>Gradient variants</h2>
<h3>a) Head based gradient \(\nabla \Psi(\theta)\)</h3>
<p>The two connections types, <a class="el" href="classcmf_1_1upslope_1_1connections_1_1_richards__lateral.html">Richards_lateral</a> and <a class="el" href="classcmf_1_1upslope_1_1connections_1_1_darcy.html">Darcy</a> are using the real, water content dependent head of the connected soillayers to calculate the gradient. This makes it more difficult to solve, yet more realistic than option b.</p>
<p class="formulaDsp">
\[
 \nabla \Psi = \frac{\Psi_1(\theta_1) - \Psi_2(\theta_2)}{d} 
\]
</p>
<p>where \(d\) is the distance between the soil layers.</p>
<h3>b) Topographic gradient \(\nabla \Psi(z)\)</h3>
<p>To make the system simpler to solve, in this option, used by <a class="el" href="classcmf_1_1upslope_1_1connections_1_1_topographic_gradient_darcy.html">TopographicGradientDarcy</a> and <a class="el" href="classcmf_1_1upslope_1_1connections_1_1_darcy_kinematic.html">DarcyKinematic</a>, the topographic elevation of the cells is used as a proxy for the real water pressure head. This option is much simpler to solve for the system, however, the results are only realistic in case of water tables roughly parallel to the surface.</p>
<p class="formulaDsp">
\[
 \nabla \Psi = \frac{z_{cell,1} - z_{cell,2}}{d} 
\]
</p>
<h2>Connecting cell layers using a darcian lateral connection</h2>
<p>All dedicated lateral connection provide the same interface for the creation of a connection. Below we are going to use <code>cmf.Darcy</code> as an example, but it works the same way with the other three connections.</p>
<div class="fragment"><div class="line">cmf.Darcy(leftnode, rightnode, FlowWidth, distance=0)</div>
</div><!-- fragment --><ul>
<li><code>leftnode</code> needs to be a <a class="el" href="classcmf_1_1upslope_1_1_soil_layer.html">SoilLayer</a> object - <code>rightnode</code> is any <a class="el" href="classcmf_1_1water_1_1flux__node.html">flux_node</a> object - <code>FlowWidth</code> is the width of the connection in m - <code>distance</code> is the distance between <code>leftnode</code> and <code>rightnode</code> in m. If it is left to 0 (default), the distance is calculated from the position of the nodes.</li>
</ul>
<p>When <code>rightnode</code> is another soillayer the flow thickness is calculated as the common interface of the soillayers according to their depth below ground. Otherwise the interface A is calculated as the thickness of <code>leftnode</code> times the flow width.</p>
<p>However, if you have several cells with a defined <a class="el" href="cmf_tut_cell.html">topology</a>, one can use the topological information and create lateral connections for all layers of all cells with a single command:</p>
<div class="fragment"><div class="line"><a class="code hl_function" href="namespacecmf.html#ab4c483a2823be1189ba949bd25b2cbdf">cmf.connect_cells_with_flux</a>(cells, cmf.Darcy, start_at_layer=0)</div>
<div class="ttc" id="anamespacecmf_html_ab4c483a2823be1189ba949bd25b2cbdf"><div class="ttname"><a href="namespacecmf.html#ab4c483a2823be1189ba949bd25b2cbdf">cmf.connect_cells_with_flux</a></div><div class="ttdeci">connect_cells_with_flux(cells, connection, start_at_layer=0)</div><div class="ttdef"><b>Definition</b> __init__.py:30</div></div>
</div><!-- fragment --><p>Here, cells is a collection of cells, eg. the whole project or a list of cells if you want to install the connection only for a part of your cells. The <code>start_at_layer</code> argument is optional. If it is set to a number <code>n</code>, the connection is not installed for the <code>n-1</code> upper layers of a cell. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<hr class="footer"/><address class="footer"><small>
<div>&copy 2008-2017 by 
<a class="el" href="http://www.uni-giessen.de/hydro/kraft"> Philipp Kraft</a> and
<a class="el" href="http://www.uni-giessen.de/hydro"> 
Institute of Landscape Ecology and Resources Management,University of Gie&szlig;en</a>
</h3></td>
<td>Generated: Fri Jan 19 2024 16:10:56</td>
</tr></table>
</small></address>
</body>
</html>
