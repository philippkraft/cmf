<!-- HTML header for doxygen 1.8.14-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <meta name="generator" content="Doxygen 1.10.0"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>cmf: Is hydrology kinematic?</title>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="dynsections.js"></script>
    <script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
    <script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
    <script type="text/javascript">
        DoxygenAwesomeDarkModeToggle.init()
        DoxygenAwesomeFragmentCopyButton.init()
    </script>
    <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js"></script>
    <link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="cmf-logo-2018.svg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
  <div id="projectnumber">2.0.0b10</div>
   <div id="projectbrief">catchment modelling framework</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('cmf_tut_kinematic_wave.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Is hydrology kinematic?</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>... is the title of a paper by <a href="https://doi.org/10.1002/hyp.306">Singh (2002)</a>, where he lists numerous examples from all scales of hydrology where a kinematic wave function has been found to be a valid descriptor for hydrological processes. Anyway, numerous more or less conceptional models in hydrology use kinematic wave like formulations to calculate fluxes. While some authors are happy to call every 1st order flux calculation using some exponent a kinematic wave, other authors like to see the term reserved for more "wave like" phenomens in hydrology.</p>
<p>Hence a number of different names exist for the same concept:</p>
<ul>
<li>Kinematic wave</li>
<li>Power law equation (eg. DHSVM, SUPERFLEX)</li>
<li>curve shape parameter (eg. MACRO, HBVlight)</li>
</ul>
<h2>A simplified equation for power law equations</h2>
<p>A generalized form for some approaches is:</p>
<p class="formulaDsp">
\[
q(V) = Q_0 \cdot \theta^\beta\ (1)
\]
</p>
<p>where:</p>
<ul>
<li>\(\theta\) is a dimensonless variable representing a water content related state of a storage</li>
<li>\(\beta\) is a curve shape parameter</li>
<li>\(Q_0\) is the flux in m³/day at unity state \(\theta=1\)</li>
</ul>
<p>For cmf, using the finite volume approach, we need a consistent function to relate the stored water volume \(V\) in a water storage to the variable \(\theta\). So we define:</p>
<p class="formulaDsp">
\[
\theta = \frac{V - V_{res}}{V_0}\ (2)
\]
</p>
<p>where:</p>
<ul>
<li>\(V\) is the water volume stored in a storage in \(m^3\)</li>
<li>\(V_{res}\) is an immobile water volume in the storage, that does not take place in this connection. It may be ommitted and set to \( 0
  m^3\).</li>
<li>\(V_0\) is a reference volume, where, for any \(\beta\) the runoff from the water storage is \(Q_0\).</li>
</ul>
<p>The famous linear storage equation can be seen as a special case of this approach where \(\beta=1\). In that case, we can rearrange the formula above to:</p>
<p class="formulaDsp">
\[
q(V) = \frac{Q_0}{V_0} \cdot (V-V_{res})\ (3)
\]
</p>
<p>Here the quotient \(\frac{Q_0}{V_0}\) becomes the inverse of the storage residence time \(t_r^{-1}\), which simplifies (3) to <br  />
</p>
<p class="formulaDsp">
\[
q(V) = \frac 1 {t_r [days]} \cdot (V-V_{res})\ (4)
\]
</p>
<p>for the linear case</p>
<h1>Implementation in cmf</h1>
<p>Due to the different meanings of parameters between the linear and non-linear case, cmf provides now 2 distinct connections for the linear and the non-linear case.</p>
<h2>LinearStorageConnection</h2>
<div class="fragment"><div class="line">ls = cmf.LinearStorageConnection(source, target, residencetime=3.2, residual=0)</div>
</div><!-- fragment --><p>The linear storage connection <a class="el" href="classcmf_1_1water_1_1_linear_storage_connection.html">LinearStorageConnection</a> implements (4) and takes the residence time in days and a residual water content in m³ as parameters. While the residence time must be given, the residual water content can be omitted and set to 0. Depending on system size and structure, residence times between minutes for surface water storages or fast drainages up to hundreds of years for large aquifers are suitable values.</p>
<h2>PowerLawConnection</h2>
<div class="fragment"><div class="line">plc = cmf.PowerLawConnection(source, target, Q0=3.0, V0=5.3, beta=2.0, residual=0)</div>
</div><!-- fragment --><p>The power law connection (<a class="el" href="classcmf_1_1water_1_1_power_law_connection.html">PowerLawConnection</a>) needs the parameters Q0, V0 and beta as given in the generalized form of the power law equation. The reference flow \(Q_0 [\frac{m^3}{days}]\) occurs when the source water storage contains the reference volume \(V_0\) as mobile water. The curve shape parameter \(\beta\) bends the curve for mobile water volumes between 0 and \(V0\) down, when \(\beta&gt;1\). The curve is bend up for \(\beta&lt;1\). If \(V -
V_{res}&gt;V_0\), the effect is directly turned around, as shown in the figure.</p>
<p>The residual water content \(V_{res} [m^3]\) shifts the storage/runoff response to the right.</p>
<p>A residual water content makes sense eg. for percolation in simplified models where percolation starts only above field capacity, where the residual water content equals field capacity of the top soil, or it can be used as the volume behind a dam. To find a justification for \(\beta\) is more challenging: \(\beta&gt;1\) describes systems, where flow is over linear slow for low storages and gets much faster for a large storage. Unsaturated flow can be modelled that way, if one takes an analogy with the Brooks-Corey retention curve, betas from 4 to 15 are reasonable. The standard beta for the "real" kinematic wave from the Manning-Strickler equation for sheet flow in \(\frac 5 3\). If you find a real world usage for \(\beta&lt;1\), please inform the authors of cmf. However, if \(\beta&lt;0.3\) it is reported, that numerical instabilities will arise.</p>
<div class="image">
<img src="PowerLawConnection.png" alt=""/>
</div>
     </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<hr class="footer"/><address class="footer"><small>
<div>&copy 2008-2017 by 
<a class="el" href="http://www.uni-giessen.de/hydro/kraft"> Philipp Kraft</a> and
<a class="el" href="http://www.uni-giessen.de/hydro"> 
Institute of Landscape Ecology and Resources Management,University of Gie&szlig;en</a>
</h3></td>
<td>Generated: Fri Jan 19 2024 16:10:56</td>
</tr></table>
</small></address>
</body>
</html>
