<!-- HTML header for doxygen 1.8.14-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <meta name="generator" content="Doxygen 1.10.0"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>cmf: Boundary conditions</title>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="dynsections.js"></script>
    <script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
    <script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
    <script type="text/javascript">
        DoxygenAwesomeDarkModeToggle.init()
        DoxygenAwesomeFragmentCopyButton.init()
    </script>
    <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js"></script>
    <link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="cmf-logo-2018.svg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
  <div id="projectnumber">2.0.0b10</div>
   <div id="projectbrief">catchment modelling framework</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('cmf_tut_boundary.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Boundary conditions</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="el" href="cmf_tut_first_model.html">back...</a> <a class="el" href="cmf_tut_fluxes.html">next...</a></p>
<p>The first model from the last chapter is truely mass conservant. No water is entering or leaving the system. In this chapter the system will be opened up to be influenced by the system environment.</p>
<h2>Creating an outlet</h2>
<p>As a first step we will create a system outlet. The setup from the last chapter was:</p>
<div class="fragment"><div class="line"><span class="comment"># We are going to need the datetime module</span></div>
<div class="line"><span class="keyword">import</span> datetime</div>
<div class="line"><span class="keyword">import</span> cmf</div>
<div class="line">p = <a class="code hl_class" href="classcmf_1_1project.html">cmf.project</a>()</div>
<div class="line">W1 = p.NewStorage(name=<span class="stringliteral">&quot;W1&quot;</span>)</div>
<div class="line">W2 = p.NewStorage(name=<span class="stringliteral">&quot;W2&quot;</span>)</div>
<div class="line">q = cmf.LinearStorageConnection(source=W1, target=W2, residencetime=1.0)</div>
<div class="line">W1.volume = 1.0</div>
<div class="ttc" id="aclasscmf_1_1project_html"><div class="ttname"><a href="classcmf_1_1project.html">cmf::project</a></div><div class="ttdoc">The study area, holding all cells, outlets and streams.</div><div class="ttdef"><b>Definition</b> project.h:53</div></div>
</div><!-- fragment --><p>Now we add an outlet <a class="el" href="classcmf_1_1water_1_1_dirichlet_boundary.html">DirichletBoundary</a> to the project and connect W2 with that outlet, using a linear storage connection with a longer residence time</p>
<div class="fragment"><div class="line">Out = p.NewOutlet(name=<span class="stringliteral">&quot;Outlet&quot;</span>)</div>
<div class="line">qout = cmf.LinearStorageConnection(source=W2,target=Out,residencetime=2.0)</div>
</div><!-- fragment --><p>At last the new system needs to be solved again, the same way as the first model:</p>
<div class="fragment"><div class="line"><span class="comment"># Create the solver</span></div>
<div class="line">solver = cmf.RKFIntegrator(p,1e-9)</div>
<div class="line"><span class="comment"># Iterate the solver hourly through the time range and return for each time step the volume in W1 and W2</span></div>
<div class="line">result = [[W1.volume,W2.volume] <span class="keywordflow">for</span> t <span class="keywordflow">in</span> solver.run(datetime.datetime(2012,1,1),datetime.datetime(2012,1,7),datetime.timedelta(hours=1))]</div>
<div class="line"><span class="keyword">import</span> pylab <span class="keyword">as</span> plt</div>
<div class="line">plt.plot(result)</div>
<div class="line">plt.xlabel(<span class="stringliteral">&#39;hours&#39;</span>)</div>
<div class="line">plt.ylabel(<span class="stringliteral">&#39;Volume in $m^3$&#39;</span>)</div>
<div class="line">plt.legend((<span class="stringliteral">&#39;W1&#39;</span>,<span class="stringliteral">&#39;W2&#39;</span>))</div>
<div class="line">plt.show()</div>
</div><!-- fragment --><p>This results in:</p>
<div class="image">
<img src="CmfTutBoundaryOut.png" alt=""/>
</div>
    <h2>Creating an input boundary condition</h2>
<p>To extend our model with input flux, we can add a Neumann boundary condition (<a class="el" href="classcmf_1_1water_1_1_neumann_boundary.html">NeumannBoundary</a>) as a second boundary. This type of boundary condition is not triggered by the state of a water storage in the system, but by a defined flux given by the user. Since the flux should change over time, the flux is given as a <a class="el" href="cmf_tut_space_time.html">timeseries</a>. In this tutorial you will create a timeseries with daily alternating flux values between 0 and 1.</p>
<p>The setup code needs to be extended with the following:</p>
<div class="fragment"><div class="line"><span class="comment"># Create a Neumann Boundary condition connected to W1</span></div>
<div class="line">In = cmf.NeumannBoundary.create(W1)</div>
<div class="line"><span class="comment"># Create a timeseries with daily alternating values.</span></div>
<div class="line">In.flux = cmf.timeseries(begin = datetime.datetime(2012,1,1), </div>
<div class="line">                         step = datetime.timedelta(days=1), </div>
<div class="line">                         interpolationmethod = 0)</div>
<div class="line"><span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(10):</div>
<div class="line">    <span class="comment"># Add 0.0 m3/day for even days, and 1.0 m3/day for odd days</span></div>
<div class="line">    In.flux.add(i % 2)</div>
</div><!-- fragment --><p>That's it. And the result is:</p>
<div class="image">
<img src="CmfTutBoundaryInOut.png" alt=""/>
</div>
    <p>If the input timeseries is replaced by measured net rainfall data and the residence times of the storages are calibrated, you might be lucky to predict some catchments correctly. However, cmf contains many, many more connection types than <a class="el" href="classcmf_1_1water_1_1_linear_storage_connection.html">linear storage connections</a>. Some of the connection types are shown in the next chapters. A list of all connections is <a class="el" href="group__connections.html">here</a>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<hr class="footer"/><address class="footer"><small>
<div>&copy 2008-2017 by 
<a class="el" href="http://www.uni-giessen.de/hydro/kraft"> Philipp Kraft</a> and
<a class="el" href="http://www.uni-giessen.de/hydro"> 
Institute of Landscape Ecology and Resources Management,University of Gie&szlig;en</a>
</h3></td>
<td>Generated: Fri Jan 19 2024 16:10:56</td>
</tr></table>
</small></address>
</body>
</html>
